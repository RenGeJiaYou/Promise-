<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      /*
        Promise çš„é“¾å¼è°ƒç”¨ 
        then() è¿”å›žä¸€ä¸ªã€æ–° Promise å¯¹è±¡ã€‘, çŠ¶æ€ç”± è¿™ä¸ª then() çš„è¿”å›žå€¼å†³å®š
            1.è¿”å›žçš„æ˜¯éž Promise å€¼ a (ä¸ç®¡åœ¨ resolve() è¿˜æ˜¯rejected() è¿”å›ž) -> ã€æ–° Promise å¯¹è±¡ã€‘çŠ¶æ€ï¼šfulfilled;  value:a
            2.è¿”å›žçš„æ˜¯ Promise å€¼ -> ã€æ–° Promise å¯¹è±¡ã€‘çŠ¶æ€ã€å€¼å’Œè¿”å›žçš„ Promise å®žä¾‹ä¸€è‡´
            3.then()æ‰€æŒ‡å®šçš„å›žè°ƒæŠ›å‡ºå¼‚å¸¸ -> ã€æ–° Promise å¯¹è±¡ã€‘çŠ¶æ€ï¼šrejected;   reason:æ‰€æŠ›å‡ºçš„é‚£ä¸ªå¼‚å¸¸ 
        */

      const p1 = new Promise((resolve, reject) => {
        setTimeout(() => {
          //   resolve("a");     //p1.then() è°ƒç”¨ resolve()
          reject("a"); //p1.then() è°ƒç”¨ rejected()
        }, 1000);
      });

      p1.then(
        value => {
          return " returner of p1 resolve"; //å°†è¿”å›žç»™æ–°å»ºçš„å®žä¾‹å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä¸‹ä¸€ä¸ª then() çš„ resolve(value) é‡Œ
        },
        reason => {
          return " returner of p1 rejected "; //å°†è¿”å›žåˆ°ä¸‹ä¸€ä¸ª then() çš„ resolve(reason) é‡Œ
        }
      )
        .then(
          value => {
            console.log(value, "p2 success");
            return Promise.resolve("p2 success");
          },
          reason => {
            console.log(reason, "p2 fail");
            return Promise.reject("p2 fail");
          }
        )
        .then(
          value => {
            console.log(value, "p3 success");
          },
          reason => {
            console.log(reason, "p3 fail");
          }
        );

      //éªŒè¯æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸
      const p2 = new Promise((resolve, reject) => {
        resolve("a");
      });
      p2.then(
        value => {
          throw new Error("ERR"); //æ‰§è¡Œ ðŸ‘‡66è¡Œ
        },
        reason => {}
      ).then(
        value => {
          console.log("success", value);
        },
        reason => {
          console.log("fail ", reason);
        }
      );
    </script>
  </body>
</html>
